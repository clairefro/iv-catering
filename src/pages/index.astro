---
import Container from "../components/Container.astro";
import Layout from "../layouts/Layout.astro";
import { getFeaturedTestimonials } from "../content/contentfulService.js";
import { documentToHtmlString } from "@contentful/rich-text-html-renderer";

const featuredTestimonials = await getFeaturedTestimonials();
---

<Layout>
  <h1 style="display:none;">Iovino's Catering</h1>

  <section class="home-hero">
    <Container>
      <img
        src="/assets/iovinos-logo.png"
        alt="Iovino's Catering"
        class="logo-banner"
        style="margin-bottom:2rem;"
        onload="this.style.opacity=1"
      />

      <img
        src="/assets/hero1.webp"
        alt="Iovino's Catering"
        class="fade hero-img"
        onload="this.style.opacity=1"
      />

      <div class="home-tagline-secondary">
        Authentic Italian in Corvallis, Oregon
      </div>

      <div style="font-size:0.9em;">
        <h2>Welcome!</h2>
        <p>
          I'm <strong>Regina Iovino</strong>, former chef and and owner of <strong
            >Iovino's Ristorante</strong
          > and
          <strong>Iovino's Cucina</strong> in Corvallis. An Italian chef at heart,
          I'm inspired by the rich traditions, flavors, and spirit of Italy.
        </p>
        <p>
          For me, catering isn't about trays of food, it's about creating
          moments. I want you and your guests to feel welcomed, cared for, and
          completely satisfied. I want laughter around the table, seconds (and
          thirds), and memories that linger long after the last bite. Feeding
          people brings me pure joy. And yes, my contagious laugh usually makes
          an appearance at every event.
        </p>
        <p>
          Whether it's an intimate dinner, a family celebration, or a grand
          gathering, I pour authenticity, generosity, and vibrant Italian flavor
          into everything I create.
        </p>
        <p>
          Come hungry - I'll take care of the rest. I look forward to cooking
          for your family and friends on your special occasion!
        </p>
        <img
          src="/assets/regina.jpg"
          alt="Regina Iovino"
          class="home-regina-img"
        />
      </div>
      <div class="home-links">
        <a href="/menu">View Menu</a>
        <a href="/gallery">See Gallery</a>
        <a href="/contact">Contact</a>
      </div>
    </Container>
  </section>

  <div class="platter-banner">
    <img
      src="/assets/platter-wide.webp"
      alt="Iovino's Catering platter"
      class="fade"
      loading="lazy"
      onload="this.style.opacity=1"
    />
  </div>
  <section class="highlighted">
    <Container>
      <div>
        <h2>Services</h2>
        <div style="margin-bottom:2rem;">
          <p>Authentic Italian catering for any occasion</p>
          <p>Personalized menus and warm hospitality</p>
          <p>Beautiful presentations and memorable experiences</p>
        </div>

        <div class="services-container">
          {/** Service cards data and rendering */}
          {
            (() => {
              const services = [
                {
                  image: "/assets/platter-wide2.webp",
                  title: "Delivery Platters",
                  description: [
                    "Italian dishes delivered, ready to serve",
                    "Perfect for office lunches, parties, and family gatherings",
                  ],
                  cta: { label: "Order Platters", link: "/contact" },
                },
                {
                  image: "/assets/iprepyoubake.webp",
                  title: "I Prep, You Bake",
                  description: [
                    "Gourmet Italian dishes, expertly prepped by Regina",
                    "Personalized menu, delivered to you",
                    "Enjoy fresh-from-the-oven flavor at home—just heat and serve!",
                  ],
                  cta: { label: "Order Meals", link: "/contact" },
                },
                {
                  image: "/assets/regina-onsite-chef.webp",
                  title: "On-site Chef",
                  description: [
                    "Regina cooks and serves at your event",
                    "Personalized menu planning",
                    "Warm service, full setup and cleanup included",
                  ],
                  cta: { label: "Book Chef", link: "/contact" },
                },
                // Add more service objects here as needed
              ];
              return services.map((service) => (
                <div class="service-card">
                  <img
                    src={service.image}
                    alt={service.title}
                    class="service-img"
                    loading="lazy"
                  />
                  <div class="service-card-content">
                    <h2>{service.title}</h2>
                    <ul class="service-desc">
                      {service.description.map((item) => (
                        <li>{item}</li>
                      ))}
                    </ul>
                    <a href={service.cta.link} class="service-cta-btn">
                      {service.cta.label}
                    </a>
                  </div>
                </div>
              ));
            })()
          }
        </div>
      </div>
    </Container>
  </section>

  <section class="services-section"></section>

  <section class="great-for-section highlighted">
    <Container>
      <div class="great-for-overlay">
        <h2>Great For</h2>
        <ul class="great-for-list no-style">
          <li>Weddings & rehearsal dinners</li>
          <li>Birthday parties & anniversaries</li>
          <li>Family reunions & holiday gatherings</li>
          <li>Corporate events & business luncheons</li>
          <li>Graduations & milestone celebrations</li>
          <li>Casual get-togethers with friends</li>
          <li>...any special occassion!</li>
        </ul>
      </div>
    </Container>
  </section>
  <section class="testimonials-section highlighted">
    <Container>
      <h2>Testimonials</h2>
      <div class="testimonials-list">
        {
          featuredTestimonials && featuredTestimonials.length > 0 ? (
            featuredTestimonials.map((testimonial: any) => (
              <div class="testimonial">
                <div
                  class="testimonial-quote"
                  set:html={documentToHtmlString(testimonial.quote)}
                />
                <div class="testimonial-author">{testimonial.author}</div>
              </div>
            ))
          ) : (
            <p>No testimonials found.</p>
          )
        }
      </div>
      <a
        style="margin-top:0;margin-bottom:1rem;"
        href="/testimonials"
        class="cta-btn">Read more →</a
      >
    </Container>
  </section>

  <section class="video-section highlighted">
    <Container>
      <h2>Make Meatballs with Me</h2>
      <div class="video-container">
        <iframe
          width="560"
          height="315"
          src="https://www.youtube-nocookie.com/embed/lvDIp5Mr63w?si=PvJtsR8DirczFZ1n"
          title="YouTube video player"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
          referrerpolicy="strict-origin-when-cross-origin"
          allowfullscreen
        >
        </iframe>
      </div>
    </Container>
  </section>

  <section>
    <Container>
      <div class="home-cta">
        <a href="/contact" class="cta-btn">Get in Touch</a>
        <p>For catering questions, menu selections, or bookings</p>
      </div>
    </Container>
  </section>

  <style>
    img {
      max-width: 100%;
    }

    .logo-banner {
      width: 65%;
    }
    .hero-img {
      max-height: 750px;
    }

    .cta-btn {
      display: inline-block;
      background: var(--accent, #eab308);
      color: #fff !important;
      font-family: var(--header-font);
      text-decoration: none !important;
      font-size: 1.15rem;
      padding: 0.9em 2em;
      margin-top: 1.2rem;
      transition: background 0.2s;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
    }
    .cta-btn:hover {
      background: #b97a1a;
    }
    .great-for-section {
      background: url("/assets/mushroom.webp") center/cover no-repeat;
      position: relative;
      min-height: 340px;
    }
    .great-for-section::before {
      content: "";
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.7); /* adjust opacity as needed */
      z-index: 0;
    }
    .great-for-overlay {
      /* background: rgba(32, 32, 32, 0.7); */
      padding: 2.5rem 1.5rem;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
      max-width: 600px;
      margin: 2rem auto;
      color: #fff;
      position: relative;
      z-index: 1;
    }
    .great-for-overlay h2,
    .great-for-overlay ul,
    .great-for-overlay li {
      color: #fff;
    }
    h2 {
      color: var(--accent);
    }

    section {
      margin: 1rem 0;
      padding: 2rem 0;
      text-align: center;
    }
    section.highlighted {
      background-color: var(--bg-highlight);
    }

    .home-regina-img {
      display: block;
      margin: 0 auto 2rem auto;
      width: 180px;
      object-fit: cover;
      border-radius: 50%;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
    }

    .home-links {
      display: flex;
      justify-content: center;
      gap: 2rem;
      margin-bottom: 2.5rem;
      flex-wrap: wrap;
      font-family: var(--header-font);
    }
    .home-links a {
      background-color: var(--text);
      color: #fff;
      padding: 0.7em 1.5em;
      text-decoration: none;
      font-size: 1.08rem;
      transition: background 0.2s;
    }
    .home-links a:hover {
      background: #b97a1a;
      font-family: var(--header-font);
    }

    .home-cta {
      margin-top: 2.5rem;
      font-size: 1.15rem;
      color: #222;
    }
    .home-cta a {
      color: var(--accent, #eab308);
      text-decoration: underline;
      font-family: var(--header-font);
    }

    .hero-bg-img {
      position: absolute;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100%;
      object-fit: cover;
      z-index: 1;
      display: block;
      pointer-events: none;
    }
    section.home-hero {
      padding-top: 0rem !important;
    }
    .platter-banner {
      width: 100%;
    }
    .platter-banner img {
      width: 100vw;
      height: 540px;
      display: block;
      object-fit: cover;
    }

    .great-for-list {
      list-style-type: none;
      text-align: center;
      margin: 0 auto;
      max-width: 600px;
      padding: 0;
    }
    .great-for-list li {
      margin-bottom: 0.8em;
    }

    .home-tagline-secondary {
      text-align: center;
      font-size: 1.13rem;
      color: #b97a1a;
      margin: 1.2rem 0 0.5rem 0;
      font-family: var(--header-font, serif);
      letter-spacing: 0.01em;
    }

    .services-container {
      display: flex;
      gap: 1.5rem;
      flex-wrap: wrap;
    }
    .services-container > * {
      flex: 1 1 340px;
      min-width: 300px;
      max-width: 100%;
      box-sizing: border-box;
    }
    .service-card {
      flex: 1 1 100%;
      background: var(--bg-highlight, #f8f8f8);
      /* border-radius: 12px; */
      /* border: 2px solid var(--accent); */
      box-shadow: 0 6px 32px rgba(0, 0, 0, 0.16);
      margin: 0 0.5rem;
      min-width: 220px;
      max-width: 538px;
      text-align: center;
      display: flex;
      flex-direction: column;
      align-items: stretch;
      min-height: 600px;
      height: 100%;
      justify-content: flex-start;
      position: relative;
      padding: 0;
      overflow: hidden;
    }
    .service-card h2 {
      color: var(--accent);
      margin: 1rem 0 0.7rem 0;
    }
    .service-img {
      width: 100%;
      height: 250px;
      min-height: 140px;
      object-fit: cover;
      box-shadow: 0 1px 6px rgba(0, 0, 0, 0.07);
      /* flex-shrink: 0; */
      display: block;
      max-width: none;
      align-self: stretch;
      /* border-radius: 12px 12px 0 0; */
      margin-bottom: 0;
    }

    .service-card-content {
      padding: 2rem 1.5rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      flex: 1 1 auto;
      height: 100%;
    }
    .service-desc {
      list-style: none;
      margin: 0 0 1.2rem 0;
      padding: 0;
      text-align: center;
      color: #444;
      font-size: 1rem;
      flex: 1 1 100%;
      align-self: stretch;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
    }
    .service-desc li {
      margin-bottom: 0.4em;
      padding-left: 0;
      position: relative;
    }

    .service-desc li {
      margin-bottom: 0.75em;
    }
    .service-cta-btn {
      display: inline-block;
      background: var(--accent, #eab308);
      color: #fff !important;
      font-family: var(--header-font);
      text-decoration: none !important;
      font-size: 1.05rem;
      padding: 0.7em 1.5em;
      transition: background 0.2s;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.07);
      align-self: center;
      margin-top: auto;
      margin-bottom: 0.5rem;
      position: relative;
      z-index: 2;
    }
    .service-cta-btn:hover {
      background: #b97a1a;
    }
    .service-card > h2 {
      margin-top: 0.5rem;
      margin-bottom: 0.7rem;
      flex-shrink: 0;
      min-height: 2.6em;
      display: flex;
      align-items: center;
      justify-content: center;
      line-height: 1.2;
      text-align: center;
    }

    .testimonials-section {
      background: var(--bg-highlight);
      padding: 2.5rem 0 2rem 0;
      text-align: center;
    }
    .testimonials-list {
      display: flex;
      gap: 2rem;
      justify-content: center;
      flex-wrap: wrap;
      margin-bottom: 2rem;
    }
    .testimonial {
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
      padding: 2rem 1.5rem 1.5rem 1.5rem;
      max-width: 340px;
      flex: 1 1 260px;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 1.5rem;
    }
    .testimonial-quote {
      font-style: italic;
      color: #444;
      font-size: 1.08rem;
      margin-bottom: 1.2rem;
    }
    .testimonial-author {
      color: var(--accent);
      font-weight: bold;
      font-size: 1rem;
    }

    .testimonials-cta-wrapper {
      display: flex;
      justify-content: center;
      margin: 1.5rem 0 0 0;
    }

    .fade {
      opacity: 0;
      transition: opacity 0.3s;
    }

    .video-section {
      padding: 2.5rem 0;
      text-align: center;
    }
    .video-container {
      position: relative;
      padding-bottom: 56.25%;
      height: 0;
      overflow: hidden;
      max-width: 100%;
      margin: 0 auto 2rem auto;
    }
    .video-container iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: none;
    }

    @media (max-width: 600px) {
      .home-links {
        flex-direction: column;
        gap: 1.2rem;
      }
      .home-highlight {
        padding: 1.1rem 0.5rem;
      }
      .home-regina-img {
        width: 140px;
      }

      .platter-banner img {
        height: 350px;
      }

      section {
        margin-top: 0;
      }

      .services-container {
        flex-direction: column;
        gap: 1.5rem;
      }
      .service-card {
        width: 100%;
        margin: 0 auto;
      }
      .service-card img {
        height: 300px;
      }

      .testimonials-list {
        gap: 0;
        margin-bottom: 1.5rem;
      }
    }
  </style>
</Layout>
